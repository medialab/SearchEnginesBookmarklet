<html>
  <head>
    <title>Search Engines Bookmarklet</title>
    <style>
body {
  font-family: Sans-serif;
  margin: auto;
  padding-top: 3%;
  text-align: center;
}
img {
  height: 48px;
  margin: 12px;
}
    </style>
  </head>
  <body>
    <h1>Install Search Engines Bookmarklet</h1>
    <p>This bookmarklet (built for Firefox &amp; Chrome only) can be used to easily extract search results from Google, DuckDuckGo, Baidu, Qwant and Bing.</p>
    <p>Drag &amp; drop the image below into your bookmarks bar (you may first need to enable its display from your browser's menu):</p>
    <a id="bookmark" href=""><img src="images/new-google.png" alt="SearchEngineBookmarklet"/></a>
  </body>
  <script>
document.addEventListener("DOMContentLoaded", function() {
  var buildBookmarklet = function(hrefId, scriptName) {
    var res = "javascript:(function(){" +
                    "var script = document.createElement('script')," +
                    "userAgent = navigator.userAgent," +
                    "CSP = 'CSP blocking detected! Unable to load scripts.'," +
                    "popup = '\\nTry to use this extension (you need to allow pop-up on your browser)';" +
                    "script.type = 'text/javascript';" +
                    "script.src = '" + window.location.href.replace(/^https?:/, '').replace(/\/?(index.html)?$/, '/') + scriptName + ".js';" +
                    "var bod = document.getElementsByTagName('body')[0];" +
                    "var href = window.location.href;" +
                    "if(~href.search(/:\\/\\/([^.]+\\.)?bing\\.[^/]+\\//)){" +
                    "HTMLBodyElement.prototype.appendChild = Node.prototype.appendChild;}" +
                    "bod || (bod = document.createElement('body'), document.documentElement.appendChild(bod));" +
                    "bod.appendChild(script);" +
                    "script.onerror = function() {" +
                    "if(userAgent.indexOf('Chrome') > -1) {" +
                    "window.alert(CSP + popup);" +
                    "window.open('https://chromewebstore.google.com/detail/allow-csp-content-securit/hnojoemndpdjofcdaonbefcfecpjfflh');}" +
                    "else if (userAgent.indexOf('Firefox') > -1){" +
                    "window.alert(CSP + popup);" +
                    "window.open('https://addons.mozilla.org/en-US/firefox/addon/mheadercontrol/');}" +
                    "else{" +
                    "window.alert(CSP);}};" +
                  "})()";
    document.getElementById(hrefId).href = res.replace(/\s+/g, '%20');
  };
  buildBookmarklet("bookmark", "SearchEnginesBookmarklet");
});
  </script>
</html>
