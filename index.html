<html>
<title>Search Engine Bookmarklets</title>
<style>
body {
  font-family: Sans-serif;
  margin: auto;
  padding-top: 3%;
  text-align: center;
}
img {
  height: 48px;
  margin: 12px;
}
</style>
<body>
<h1>Install Search Engine Bookmarklets</h1>

<p>This bookmarklet can be used on google and duckduckgo domains.</p>
<p>Drag &amp; drop the image below into your bookmark bar:</p>

<a id="bookmark" href=""><img src="images/new-google.png" alt="SearchEngineBookmarklet"/></a>

</body>
<script>
document.addEventListener("DOMContentLoaded", function(){
  var buildBookmarklet = function(hrefId, scriptName){
    var res = "javascript:(function(){" +
                "var script = document.createElement('script');" +
                "script.type = 'text/javascript';" +
                "script.src = '" + window.location.href.replace(/^https?:/, '').replace(/\/?(index.html)?$/, '/') + scriptName + ".js';" +
                "var bod = document.getElementsByTagName('body')[0];" +
                "var href = window.location.href;" +
                "if(~href.search(/:\\/\\/([^.]+\\.)?bing\\.[^/]+\\//)){" +
                "HTMLBodyElement.prototype.appendChild = Node.prototype.appendChild;}" +
                "bod || (bod = document.createElement('body'), document.documentElement.appendChild(bod));" +
                "bod.appendChild(script);" +
                "script.onerror = function() {window.alert('CSP blocking detected! Unable to load scripts.');}" +
              "})()";
    document.getElementById(hrefId).href = res.replace(/\s+/g, '%20');
  };
  buildBookmarklet("bookmark", "SearchEngineBookmarklet");
});
</script>
</html>
